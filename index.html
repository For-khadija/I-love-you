<!DOCTYPE html>
<html lang="ar">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>ğŸ’</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/loaders/GLTFLoader.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/controls/OrbitControls.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
        }
        
        body {
            background-color: #000;
            color: #fff;
            height: 100vh;
            width: 100vw;
            overflow: hidden;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, sans-serif;
            touch-action: manipulation;
        }
        
        #container {
            width: 100%;
            height: 100%;
            position: relative;
        }
        
        #scene-container {
            width: 100%;
            height: 100%;
            position: absolute;
            top: 0;
            left: 0;
        }
        
        /* Ø´Ø§Ø´Ø© Ø§Ù„Ø§Ù†ØªØ¸Ø§Ø± */
        #waiting-screen {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, #0c0c0c 0%, #1a1a1a 100%);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 100;
            transition: opacity 0.8s ease;
        }
        
        #waiting-screen.hidden {
            opacity: 0;
            pointer-events: none;
        }
        
        .waiting-content {
            text-align: center;
            max-width: 90%;
            padding: 20px;
        }
        
        .waiting-emoji {
            font-size: 3rem;
            margin-bottom: 15px;
            animation: float 3s ease-in-out infinite;
        }
        
        .waiting-text {
            font-size: 2rem;
            color: #fff;
            margin-bottom: 10px;
            text-shadow: 0 0 10px rgba(255, 255, 255, 0.5);
        }
        
        .arabic-waiting {
            font-size: 1.5rem;
            color: #ff6699;
            font-style: italic;
            margin-top: 5px;
            opacity: 0.9;
        }
        
        .loading-dots {
            display: flex;
            justify-content: center;
            margin-top: 20px;
            gap: 8px;
        }
        
        .dot {
            width: 10px;
            height: 10px;
            background: #ff3366;
            border-radius: 50%;
            animation: pulse 1.5s infinite;
        }
        
        .dot:nth-child(2) {
            animation-delay: 0.2s;
        }
        
        .dot:nth-child(3) {
            animation-delay: 0.4s;
        }
        
        /* Ø§Ù„Ø±Ø³Ø§Ù„Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© - Ù…ØµÙ…Ù…Ø© Ù„ÙƒÙ„ Ø§Ù„Ù‡ÙˆØ§ØªÙ */
        #message {
            position: absolute;
            bottom: 10px;
            left: 50%;
            transform: translateX(-50%);
            z-index: 10;
            text-align: center;
            animation: fadeIn 2s ease-out;
            background: rgba(0, 0, 0, 0.75);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            padding: 12px 20px;
            border-radius: 15px;
            border: 1px solid rgba(255, 102, 153, 0.4);
            max-width: 95%;
            width: auto;
            min-width: 280px;
            max-height: 25vh;
            overflow: hidden;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.5);
            box-sizing: border-box;
        }
        
        .message-text {
            color: #ffddee;
            font-size: 1.1rem;
            line-height: 1.4;
            text-shadow: 0 0 8px rgba(255, 221, 238, 0.6);
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            font-weight: normal;
            word-wrap: break-word;
            overflow-wrap: break-word;
            white-space: normal;
            display: block;
            margin: 0;
            padding: 0;
        }
        
        .config-btn {
            position: absolute;
            top: 15px;
            right: 15px;
            background: rgba(0, 0, 0, 0.7);
            color: #ff3366;
            border: 1px solid #ff3366;
            padding: 6px 12px;
            border-radius: 20px;
            cursor: pointer;
            font-size: 0.8rem;
            z-index: 20;
            opacity: 0.3;
            transition: opacity 0.3s;
            touch-action: manipulation;
        }
        
        .config-btn:hover,
        .config-btn:active {
            opacity: 1;
        }
        
        .config-panel {
            position: absolute;
            top: 40px;
            right: 15px;
            background: rgba(0, 0, 0, 0.95);
            border: 1px solid #ff3366;
            border-radius: 10px;
            padding: 15px;
            display: none;
            width: 90%;
            max-width: 300px;
            z-index: 20;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.5);
            box-sizing: border-box;
        }
        
        .config-panel.show {
            display: block;
        }
        
        .config-input {
            width: 100%;
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid #ff3366;
            color: white;
            padding: 8px 10px;
            border-radius: 5px;
            margin: 8px 0;
            font-size: 0.9rem;
            box-sizing: border-box;
        }
        
        .config-btn-small {
            background: #ff3366;
            color: white;
            border: none;
            padding: 8px 15px;
            border-radius: 5px;
            cursor: pointer;
            margin-top: 8px;
            font-size: 0.9rem;
            touch-action: manipulation;
            width: 100%;
        }
        
        .zoom-controls {
            position: absolute;
            bottom: 80px;
            right: 15px;
            z-index: 20;
            display: flex;
            flex-direction: column;
            gap: 8px;
        }
        
        .zoom-btn {
            background: rgba(0, 0, 0, 0.7);
            color: #ff3366;
            border: 1px solid #ff3366;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            font-size: 1.5rem;
            user-select: none;
            opacity: 0.7;
            transition: opacity 0.3s;
            touch-action: manipulation;
        }
        
        .zoom-btn:active {
            background: rgba(255, 51, 102, 0.3);
            opacity: 1;
        }
        
        /* Ø¥ØµÙ„Ø§Ø­ Ù…Ø´Ø§ÙƒÙ„ Ø§Ù„Ù…ØªØµÙØ­Ø§Øª Ø§Ù„Ù…Ø®ØªÙ„ÙØ© */
        @supports (-webkit-touch-callout: none) {
            #message {
                padding: 10px 15px;
                max-height: 30vh;
            }
            
            .message-text {
                font-size: 1rem;
            }
        }
        
        @keyframes float {
            0%, 100% { transform: translateY(0) scale(1); }
            50% { transform: translateY(-8px) scale(1.05); }
        }
        
        @keyframes pulse {
            0%, 100% { opacity: 0.3; transform: scale(0.8); }
            50% { opacity: 1; transform: scale(1); }
        }
        
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        
        /* ØªØµÙ…ÙŠÙ… Ù…ØªØ¬Ø§ÙˆØ¨ Ù„ÙƒÙ„ Ø£Ø­Ø¬Ø§Ù… Ø§Ù„Ø´Ø§Ø´Ø§Øª */
        
        /* Ù‡ÙˆØ§ØªÙ ØµØºÙŠØ±Ø© Ø¬Ø¯Ø§Ù‹ */
        @media (max-width: 320px) {
            .waiting-text {
                font-size: 1.6rem;
            }
            
            .arabic-waiting {
                font-size: 1.2rem;
            }
            
            .waiting-emoji {
                font-size: 2.5rem;
            }
            
            #message {
                bottom: 8px;
                padding: 10px 15px;
                max-width: 92%;
                max-height: 30vh;
            }
            
            .message-text {
                font-size: 0.95rem;
                line-height: 1.3;
            }
            
            .zoom-controls {
                bottom: 70px;
                right: 10px;
            }
            
            .zoom-btn {
                width: 35px;
                height: 35px;
                font-size: 1.3rem;
            }
        }
        
        /* Ù‡ÙˆØ§ØªÙ Ù…ØªÙˆØ³Ø·Ø© */
        @media (min-width: 321px) and (max-width: 375px) {
            .waiting-text {
                font-size: 1.8rem;
            }
            
            .arabic-waiting {
                font-size: 1.3rem;
            }
            
            #message {
                bottom: 10px;
                padding: 10px 16px;
                max-height: 28vh;
            }
            
            .message-text {
                font-size: 1rem;
                line-height: 1.35;
            }
        }
        
        /* Ù‡ÙˆØ§ØªÙ ÙƒØ¨ÙŠØ±Ø© */
        @media (min-width: 376px) and (max-width: 480px) {
            .waiting-text {
                font-size: 2rem;
            }
            
            .arabic-waiting {
                font-size: 1.5rem;
            }
            
            #message {
                bottom: 12px;
                padding: 12px 18px;
                max-height: 26vh;
            }
            
            .message-text {
                font-size: 1.05rem;
                line-height: 1.4;
            }
        }
        
        /* Ø£Ø¬Ù‡Ø²Ø© Ù„ÙˆØ­ÙŠØ© ØµØºÙŠØ±Ø© */
        @media (min-width: 481px) and (max-width: 768px) {
            .waiting-text {
                font-size: 2.2rem;
            }
            
            .arabic-waiting {
                font-size: 1.6rem;
            }
            
            .waiting-emoji {
                font-size: 3.5rem;
            }
            
            #message {
                bottom: 15px;
                padding: 14px 22px;
                max-height: 22vh;
                border-radius: 18px;
            }
            
            .message-text {
                font-size: 1.15rem;
                line-height: 1.45;
            }
            
            .zoom-controls {
                bottom: 90px;
                right: 20px;
            }
        }
        
        /* Ø£Ø¬Ù‡Ø²Ø© Ù„ÙˆØ­ÙŠØ© ÙƒØ¨ÙŠØ±Ø© ÙˆØ£Ø¬Ù‡Ø²Ø© Ø³Ø·Ø­ Ø§Ù„Ù…ÙƒØªØ¨ */
        @media (min-width: 769px) {
            .waiting-text {
                font-size: 2.5rem;
            }
            
            .arabic-waiting {
                font-size: 1.8rem;
            }
            
            .waiting-emoji {
                font-size: 4rem;
            }
            
            #message {
                bottom: 20px;
                padding: 15px 25px;
                max-height: 20vh;
                border-radius: 20px;
                max-width: 600px;
            }
            
            .message-text {
                font-size: 1.2rem;
                line-height: 1.5;
            }
            
            .zoom-controls {
                bottom: 100px;
                right: 25px;
            }
        }
        
        /* Ù„Ù„Ø´Ø§Ø´Ø§Øª Ø§Ù„Ø·ÙˆÙŠÙ„Ø© (Ù…Ø«Ù„ Galaxy Fold) */
        @media (max-height: 700px) {
            #message {
                max-height: 35vh;
                bottom: 5px;
                padding: 10px 15px;
            }
            
            .message-text {
                font-size: 0.95rem;
                line-height: 1.3;
            }
            
            .zoom-controls {
                bottom: 60px;
            }
            
            .waiting-emoji {
                font-size: 2.5rem;
                margin-bottom: 10px;
            }
            
            .waiting-text {
                font-size: 1.7rem;
                margin-bottom: 5px;
            }
            
            .arabic-waiting {
                font-size: 1.2rem;
            }
        }
        
        /* Ù„Ù„Ø´Ø§Ø´Ø§Øª Ø§Ù„Ù‚ØµÙŠØ±Ø© ÙˆØ§Ù„Ø¹Ø±ÙŠØ¶Ø© */
        @media (max-height: 600px) {
            #message {
                max-height: 40vh;
                bottom: 5px;
            }
            
            .waiting-content {
                padding: 10px;
            }
            
            .waiting-emoji {
                font-size: 2rem;
            }
            
            .waiting-text {
                font-size: 1.5rem;
            }
            
            .arabic-waiting {
                font-size: 1rem;
            }
        }
        
        /* ØªØ¹Ø¯ÙŠÙ„Ø§Øª Ù„Ù„ØªÙˆØ¬ÙŠÙ‡ Ø§Ù„Ø£ÙÙ‚ÙŠ */
        @media (orientation: landscape) and (max-height: 500px) {
            #message {
                bottom: 5px;
                padding: 8px 15px;
                max-height: 45vh;
                max-width: 80%;
            }
            
            .message-text {
                font-size: 0.9rem;
                line-height: 1.2;
            }
            
            .waiting-emoji {
                font-size: 2rem;
            }
            
            .waiting-text {
                font-size: 1.5rem;
            }
            
            .arabic-waiting {
                font-size: 1rem;
            }
            
            .zoom-controls {
                bottom: 50px;
                right: 10px;
            }
            
            .zoom-btn {
                width: 35px;
                height: 35px;
                font-size: 1.3rem;
            }
        }
        
        /* Ø®Ø§ØµÙŠØ© Ø§Ù„Ù„Ù…Ø³ Ù„Ù†Ø¸Ø§Ù… iOS */
        @media (hover: none) and (pointer: coarse) {
            .config-btn,
            .zoom-btn,
            .config-btn-small {
                min-height: 44px;
                min-width: 44px;
            }
            
            #message {
                border-width: 2px;
            }
        }
    </style>
</head>
<body>
    <!-- Ø´Ø§Ø´Ø© Ø§Ù„Ø§Ù†ØªØ¸Ø§Ø± -->
    <div id="waiting-screen">
        <div class="waiting-content">
            <div class="waiting-emoji">ğŸ¤ğŸ«¶</div>
            <div class="waiting-text">Just wait ...</div>
            <div class="arabic-waiting">Ø¯Ù‚ÙŠÙ‚Ø© Ø¨Ø±Ùƒ</div>
            <div class="loading-dots">
                <div class="dot"></div>
                <div class="dot"></div>
                <div class="dot"></div>
            </div>
        </div>
    </div>
    
    <!-- Ø§Ù„Ù…Ø´Ù‡Ø¯ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ -->
    <div id="container">
        <div id="scene-container"></div>
        
        <!-- Ø§Ù„Ø±Ø³Ø§Ù„Ø© - Ù…ØµÙ…Ù…Ø© Ù„ØªÙ†Ø§Ø³Ø¨ ÙƒÙ„ Ø§Ù„Ù‡ÙˆØ§ØªÙ -->
        <div id="message">
            <div class="message-text">ØªÙˆØ­Ø´ØªÙƒ Ù‡Ù‡Ù‡Ù‡ Ø³Ù…Ø­ÙŠÙ„ÙŠ Ù…Ø¨Ø¹ØªÙ„ÙƒØ´ Ø§Ù„Ø¨Ø§Ø±Ø­</div>
        </div>
        
        <!-- Ø¹Ù†Ø§ØµØ± Ø§Ù„ØªØ­ÙƒÙ… -->
        <div class="zoom-controls">
            <div class="zoom-btn" onclick="zoomIn()">+</div>
            <div class="zoom-btn" onclick="zoomOut()">âˆ’</div>
        </div>
        
        <button class="config-btn" onclick="toggleConfig()">âš™ï¸</button>
        <div class="config-panel" id="configPanel">
            <h3 style="color: #ff3366; margin-bottom: 10px; font-size: 1rem;">Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„ÙˆØ±Ø¯Ø©</h3>
            <p style="color: #ccc; margin-bottom: 5px; font-size: 0.9rem;">Ù…Ø³Ø§Ø± Ù…Ù„Ù Ø§Ù„ÙˆØ±Ø¯Ø© 3D:</p>
            
            <!-- Ø¥Ø¶Ø§ÙØ© Ø®ÙŠØ§Ø±Ø§Øª Ù…ØªØ¹Ø¯Ø¯Ø© Ù„Ù„Ù…Ø³Ø§Ø±Ø§Øª -->
            <select id="modelPathSelector" class="config-input" onchange="updateModelPath()">
                <option value="https://raw.githubusercontent.com/For-khadija/I-love-you/main/models/rose.glb">Ø§Ù„Ù…Ø³Ø§Ø± Ø§Ù„Ù…Ø­Ù„ÙŠ (models/rose.glb)</option>
                <option value="https://media.githubusercontent.com/media/For-khadija/I-love-you/main/models/rose.glb">Ø§Ù„Ù…Ø³Ø§Ø± Ø¹Ø¨Ø± GitHub Raw</option>
            </select>
            
            <input type="text" id="modelPathInput" class="config-input" 
                   placeholder="Ø£Ø¯Ø®Ù„ Ù…Ø³Ø§Ø± Ù…Ù„Ù GLB" 
                   value="models/rose.glb">
            
            <button class="config-btn-small" onclick="loadModelFromPath()">ØªØ­Ù…ÙŠÙ„ Ø§Ù„ÙˆØ±Ø¯Ø©</button>
            
            <div style="margin-top: 15px; border-top: 1px solid #ff3366; padding-top: 10px;">
                <p style="color: #ccc; margin-bottom: 8px; font-size: 0.9rem;">Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ø²ÙˆÙ…:</p>
                <div style="display: flex; gap: 8px; margin-top: 8px; flex-wrap: wrap;">
                    <button class="config-btn-small" onclick="setZoomClose()" style="flex: 1; min-width: 70px;">Ù‚Ø±ÙŠØ¨</button>
                    <button class="config-btn-small" onclick="setZoomDefault()" style="flex: 1; min-width: 70px;">ÙˆØ³Ø·</button>
                    <button class="config-btn-small" onclick="setZoomFar()" style="flex: 1; min-width: 70px;">Ø¨Ø¹ÙŠØ¯</button>
                </div>
            </div>
            
            <p style="margin-top: 10px; font-size: 0.75rem; color: #aaa; line-height: 1.3;">
                ğŸ’¡ <strong>Ù„Ø­Ù„ Ù…Ø´ÙƒÙ„Ø© GLB:</strong><br>
                1. ØªØ£ÙƒØ¯ Ù…Ù† Ø±ÙØ¹ Ù…Ù„Ù rose.glb ÙÙŠ Ù…Ø¬Ù„Ø¯ models<br>
                2. Ø£Ø¶Ù Ù…Ù„Ù <code>.nojekyll</code> ÙØ§Ø±Øº ÙÙŠ Ø§Ù„Ù…Ø¬Ù„Ø¯ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ<br>
                3. Ø§Ø³ØªØ®Ø¯Ù… Ø§Ù„Ù…Ø³Ø§Ø± Ø¹Ø¨Ø± GitHub Raw Ø¥Ø°Ø§ Ø§Ø³ØªÙ…Ø±Øª Ø§Ù„Ù…Ø´ÙƒÙ„Ø©
            </p>
        </div>
    </div>

    <script>
        // ============================================
        // Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ù…ÙˆÙ‚Ø¹ - ÙŠÙ…ÙƒÙ†Ùƒ ØªØ¹Ø¯ÙŠÙ„Ù‡Ø§ Ù‚Ø¨Ù„ Ø§Ù„Ø±ÙØ¹
        // ============================================
        const CONFIG = {
            DEFAULT_MODEL_PATH: 'models/rose.glb',
            LIGHT_COLOR: 0xff3366,
            ROTATION_SPEED: 0.0015,
            MODEL_SCALE: 1.8,
            
            // Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„ÙƒØ§Ù…ÙŠØ±Ø§ Ø§Ù„Ù…Ø¹Ø¯Ù„Ø©
            CAMERA_POSITION: {
                x: 1.2,
                y: 1.5,
                z: 3.2
            },
            
            ZOOM_CLOSE: 1.8,
            ZOOM_DEFAULT: 3.0,
            ZOOM_FAR: 4.5,
            
            CONTROLS: {
                minDistance: 1.3,
                maxDistance: 7.0,
                zoomSpeed: 0.9,
                rotateSpeed: 0.6
            }
        };
        
        // Ù…ØªØºÙŠØ±Ø§Øª Ø§Ù„Ù…Ø´Ù‡Ø¯
        let scene, camera, renderer, controls, roseModel;
        let isModelLoaded = false;
        
        // ============================================
        // Ø§Ù„ØªØµØ­ÙŠØ­Ø§Øª Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©:
        // 1. Ø¥Ø¶Ø§ÙØ© Ù…Ø¹Ø§Ù„Ø¬Ø© Ø£ÙØ¶Ù„ Ù„Ù„Ø£Ø®Ø·Ø§Ø¡
        // 2. Ø¥Ø¶Ø§ÙØ© Ø®ÙŠØ§Ø±Ø§Øª Ù…ØªØ¹Ø¯Ø¯Ø© Ù„Ù„Ù…Ø³Ø§Ø±Ø§Øª
        // 3. Ø¥ØµÙ„Ø§Ø­ Ù…Ø´ÙƒÙ„Ø© MIME types Ø¹Ù„Ù‰ GitHub Pages
        // ============================================
        
        // ØªÙ‡ÙŠØ¦Ø© Ø§Ù„Ù…Ø´Ù‡Ø¯
        function init() {
            // Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ù…Ø´Ù‡Ø¯
            scene = new THREE.Scene();
            scene.background = new THREE.Color(0x000000);
            
            // Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„ÙƒØ§Ù…ÙŠØ±Ø§
            camera = new THREE.PerspectiveCamera(60, window.innerWidth / window.innerHeight, 0.1, 1000);
            
            // ÙˆØ¶Ø¹ Ø§Ù„ÙƒØ§Ù…ÙŠØ±Ø§
            camera.position.set(
                CONFIG.CAMERA_POSITION.x,
                CONFIG.CAMERA_POSITION.y,
                CONFIG.CAMERA_POSITION.z
            );
            
            camera.lookAt(0, 0, 0);
            
            // Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø¹Ø§Ø±Ø¶
            renderer = new THREE.WebGLRenderer({ 
                antialias: true,
                alpha: true,
                powerPreference: "high-performance"
            });
            renderer.setSize(window.innerWidth, window.innerHeight);
            renderer.setPixelRatio(Math.min(window.devicePixelRatio, 2));
            renderer.shadowMap.enabled = true;
            renderer.shadowMap.type = THREE.PCFSoftShadowMap;
            
            // Ù…Ø³Ø­ Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ù…Ø´Ù‡Ø¯ Ø§Ù„Ø³Ø§Ø¨Ù‚ Ø¥Ø°Ø§ ÙƒØ§Ù† Ù…ÙˆØ¬ÙˆØ¯Ø§Ù‹
            const sceneContainer = document.getElementById('scene-container');
            while (sceneContainer.firstChild) {
                sceneContainer.removeChild(sceneContainer.firstChild);
            }
            sceneContainer.appendChild(renderer.domElement);
            
            // Ø¥Ø¶Ø§ÙØ© Ø¹Ù†Ø§ØµØ± Ø§Ù„ØªØ­ÙƒÙ…
            controls = new THREE.OrbitControls(camera, renderer.domElement);
            controls.enableDamping = true;
            controls.dampingFactor = 0.05;
            controls.enableZoom = true;
            controls.enablePan = false;
            
            controls.minDistance = CONFIG.CONTROLS.minDistance;
            controls.maxDistance = CONFIG.CONTROLS.maxDistance;
            controls.maxPolarAngle = Math.PI * 0.8;
            controls.minPolarAngle = Math.PI * 0.2;
            
            controls.zoomSpeed = CONFIG.CONTROLS.zoomSpeed;
            controls.rotateSpeed = CONFIG.CONTROLS.rotateSpeed;
            
            // Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø¥Ø¶Ø§Ø¡Ø©
            setupLighting();
            
            // Ù…Ø¹Ø§Ù„Ø¬Ø© ØªØºÙŠÙŠØ± Ø­Ø¬Ù… Ø§Ù„Ù†Ø§ÙØ°Ø©
            window.addEventListener('resize', onWindowResize);
            
            // Ø¨Ø¯Ø¡ Ø§Ù„ØªØµÙŠÙŠØ±
            animate();
            
            // ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù†Ù…ÙˆØ°Ø¬ Ø¨Ø¹Ø¯ ØªØ£Ø®ÙŠØ±
            setTimeout(() => {
                loadModelFromPath();
            }, 2000);
            
            // Ø¥Ø¶Ø§ÙØ© Ù…Ø³ØªÙ…Ø¹ Ù„ØªØºÙŠÙŠØ± Ø§Ù„ØªÙˆØ¬ÙŠÙ‡
            window.addEventListener('orientationchange', onWindowResize);
            
            // ØªØ£Ø®ÙŠØ± Ø¥Ø¶Ø§ÙÙŠ Ù„Ù„ØªØ£ÙƒØ¯ Ù…Ù† ØªØ­Ù…ÙŠÙ„ ÙƒÙ„ Ø´ÙŠØ¡
            setTimeout(onWindowResize, 100);
            
            // Ø¥Ø¶Ø§ÙØ© Ù…Ø¯ÙŠØ± Ø§Ù„Ø£Ø®Ø·Ø§Ø¡
            setupErrorHandling();
        }
        
        // Ø¥Ø¹Ø¯Ø§Ø¯ Ù…Ø¹Ø§Ù„Ø¬Ø© Ø§Ù„Ø£Ø®Ø·Ø§Ø¡
        function setupErrorHandling() {
            window.addEventListener('error', function(e) {
                console.error('Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ Ø§Ù„ØµÙØ­Ø©:', e.error);
                document.getElementById('waiting-screen').innerHTML = `
                    <div class="waiting-content">
                        <div class="waiting-emoji">âš ï¸</div>
                        <div class="waiting-text">Ø­Ø¯Ø« Ø®Ø·Ø£</div>
                        <div class="arabic-waiting">Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø© Ù„Ø§Ø­Ù‚Ø§Ù‹</div>
                        <button onclick="location.reload()" style="
                            margin-top: 20px;
                            background: #ff3366;
                            color: white;
                            border: none;
                            padding: 10px 20px;
                            border-radius: 10px;
                            cursor: pointer;
                        ">Ø¥Ø¹Ø§Ø¯Ø© ØªØ­Ù…ÙŠÙ„</button>
                    </div>
                `;
            });
        }
        
        // ØªØ­Ø¯ÙŠØ« Ù…Ø³Ø§Ø± Ø§Ù„Ù…Ù„Ù Ø¹Ù†Ø¯ ØªØºÙŠÙŠØ± Ø§Ù„Ø®ÙŠØ§Ø±
        function updateModelPath() {
            const selector = document.getElementById('modelPathSelector');
            const input = document.getElementById('modelPathInput');
            
            if (selector.value) {
                input.value = selector.value;
            }
        }
        
        // Ø¥Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ø¥Ø¶Ø§Ø¡Ø©
        function setupLighting() {
            const ambientLight = new THREE.AmbientLight(0xffffff, 0.4);
            scene.add(ambientLight);
            
            const mainLight = new THREE.DirectionalLight(0xffffff, 0.9);
            mainLight.position.set(2, 5, 3);
            mainLight.castShadow = true;
            scene.add(mainLight);
            
            const coloredLight = new THREE.PointLight(CONFIG.LIGHT_COLOR, 0.7, 20);
            coloredLight.position.set(0, 1, 2);
            scene.add(coloredLight);
            
            const rimLight = new THREE.DirectionalLight(0xffaaff, 0.3);
            rimLight.position.set(-2, 1, -2);
            scene.add(rimLight);
        }
        
        // ØªØ­Ù…ÙŠÙ„ Ø§Ù„ÙˆØ±Ø¯Ø© Ù…Ù† Ù…Ø³Ø§Ø± Ø§Ù„Ù…Ù„Ù
        async function loadModelFromPath() {
            const modelPath = document.getElementById('modelPathInput').value || CONFIG.DEFAULT_MODEL_PATH;
            
            // ØªØ­Ø¯ÙŠØ« Ø´Ø§Ø´Ø© Ø§Ù„Ø§Ù†ØªØ¸Ø§Ø±
            document.getElementById('waiting-screen').classList.remove('hidden');
            document.querySelector('.waiting-emoji').textContent = "â³";
            document.querySelector('.waiting-text').textContent = "Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„...";
            
            if (roseModel) {
                scene.remove(roseModel);
                roseModel = null;
            }
            
            try {
                const loader = new THREE.GLTFLoader();
                
                // Ø¥Ø¶Ø§ÙØ© Ù…Ø¹Ø§Ù„Ø¬ Ù„Ù„ØªÙ‚Ø¯Ù…
                const progressManager = (xhr) => {
                    if (xhr.lengthComputable) {
                        const percentComplete = (xhr.loaded / xhr.total) * 100;
                        document.querySelector('.arabic-waiting').textContent = 
                            `Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„: ${Math.round(percentComplete)}%`;
                    }
                };
                
                // Ø¥Ø¶Ø§ÙØ© Ù…Ø¹Ø§Ù„Ø¬ Ù„Ù„Ø£Ø®Ø·Ø§Ø¡
                const errorManager = (error) => {
                    console.error('Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ GLTF:', error);
                    throw error;
                };
                
                const gltf = await new Promise((resolve, reject) => {
                    loader.load(
                        modelPath,
                        resolve,
                        progressManager,
                        errorManager
                    );
                });
                
                roseModel = gltf.scene;
                
                const box = new THREE.Box3().setFromObject(roseModel);
                const center = box.getCenter(new THREE.Vector3());
                const size = box.getSize(new THREE.Vector3());
                
                const maxDim = Math.max(size.x, size.y, size.z);
                const scale = CONFIG.MODEL_SCALE / maxDim;
                
                roseModel.scale.setScalar(scale);
                roseModel.position.copy(center).multiplyScalar(-scale);
                roseModel.position.y = 0;
                
                roseModel.traverse((child) => {
                    if (child.isMesh) {
                        child.castShadow = true;
                        child.receiveShadow = true;
                        
                        if (child.material) {
                            child.material.needsUpdate = true;
                            if (child.material.color) {
                                child.material.color.multiplyScalar(1.2);
                            }
                        }
                    }
                });
                
                scene.add(roseModel);
                isModelLoaded = true;
                
                // ØªØ­Ø¯ÙŠØ« Ø´Ø§Ø´Ø© Ø§Ù„Ø§Ù†ØªØ¸Ø§Ø± Ù„Ù„Ù†Ø¬Ø§Ø­
                document.querySelector('.waiting-emoji').textContent = "âœ…";
                document.querySelector('.waiting-text').textContent = "ØªÙ… Ø§Ù„ØªØ­Ù…ÙŠÙ„!";
                document.querySelector('.arabic-waiting').textContent = "Ø¬Ø§Ø±ÙŠ Ø¥Ø¸Ù‡Ø§Ø± Ø§Ù„ÙˆØ±Ø¯Ø©...";
                
                setTimeout(() => {
                    document.getElementById('waiting-screen').classList.add('hidden');
                }, 1000);
                
            } catch (error) {
                console.error('Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù†Ù…ÙˆØ°Ø¬:', error);
                
                // ØªØ­Ø¯ÙŠØ« Ø´Ø§Ø´Ø© Ø§Ù„Ø§Ù†ØªØ¸Ø§Ø± Ù„Ù„Ø®Ø·Ø£
                document.querySelector('.waiting-emoji').textContent = "âŒ";
                document.querySelector('.waiting-text').textContent = "Ø®Ø·Ø£ ÙÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„";
                document.querySelector('.arabic-waiting').innerHTML = 
                    `Ù…Ù„Ù Ø§Ù„ÙˆØ±Ø¯Ø© ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯<br><small>ØªÙ… Ø¥Ù†Ø´Ø§Ø¡ ÙˆØ±Ø¯Ø© Ø§ÙØªØ±Ø§Ø¶ÙŠØ©</small>`;
                
                createDefaultRose();
                
                setTimeout(() => {
                    document.getElementById('waiting-screen').classList.add('hidden');
                }, 2000);
            }
        }
        
        // Ø¥Ù†Ø´Ø§Ø¡ ÙˆØ±Ø¯Ø© Ø§ÙØªØ±Ø§Ø¶ÙŠØ©
        function createDefaultRose() {
            const roseGroup = new THREE.Group();
            
            const heartGeometry = new THREE.SphereGeometry(0.2, 20, 20);
            const heartMaterial = new THREE.MeshPhongMaterial({ 
                color: 0xffcc00,
                shininess: 100,
                emissive: 0xffcc00,
                emissiveIntensity: 0.2
            });
            const heart = new THREE.Mesh(heartGeometry, heartMaterial);
            heart.castShadow = true;
            roseGroup.add(heart);
            
            for (let i = 0; i < 14; i++) {
                const petal = createPetal();
                const angle = (i / 14) * Math.PI * 2;
                const radius = 0.7;
                
                petal.position.x = Math.cos(angle) * radius;
                petal.position.y = Math.sin(angle) * radius * 0.7;
                petal.position.z = Math.sin(angle) * 0.1;
                petal.rotation.z = angle;
                
                const scale = 0.8 + Math.random() * 0.3;
                petal.scale.set(scale, scale, scale);
                petal.rotation.x = Math.random() * 0.3 - 0.15;
                petal.rotation.y = Math.random() * 0.1 - 0.05;
                
                roseGroup.add(petal);
            }
            
            for (let i = 0; i < 10; i++) {
                const petal = createPetal();
                const angle = (i / 10) * Math.PI * 2;
                const radius = 0.35;
                
                petal.position.x = Math.cos(angle) * radius;
                petal.position.y = Math.sin(angle) * radius * 0.7;
                petal.position.z = Math.sin(angle) * 0.05 + 0.1;
                petal.rotation.z = angle;
                petal.scale.set(0.5, 0.5, 0.5);
                
                roseGroup.add(petal);
            }
            
            const stemGeometry = new THREE.CylinderGeometry(0.035, 0.05, 2, 10);
            const stemMaterial = new THREE.MeshPhongMaterial({ 
                color: 0x2e8b57,
                shininess: 40
            });
            const stem = new THREE.Mesh(stemGeometry, stemMaterial);
            stem.position.y = -1.1;
            stem.castShadow = true;
            roseGroup.add(stem);
            
            for (let i = 0; i < 3; i++) {
                const leaf = createLeaf();
                leaf.position.y = -0.7 + i * 0.4;
                leaf.position.x = 0.15 + i * 0.05;
                leaf.rotation.z = Math.PI / 4;
                roseGroup.add(leaf);
            }
            
            roseModel = roseGroup;
            scene.add(roseModel);
            isModelLoaded = true;
        }
        
        function createPetal() {
            const shape = new THREE.Shape();
            
            shape.moveTo(0, 0);
            shape.bezierCurveTo(0.5, 0, 0.8, 0.5, 0.3, 1.1);
            shape.bezierCurveTo(0, 1.4, -0.3, 1.1, -0.8, 0.5);
            shape.bezierCurveTo(-0.5, 0, 0, 0, 0, 0);
            
            const extrudeSettings = {
                depth: 0.04,
                bevelEnabled: true,
                bevelSegments: 1,
                steps: 1,
                bevelSize: 0.015,
                bevelThickness: 0.015
            };
            
            const geometry = new THREE.ExtrudeGeometry(shape, extrudeSettings);
            
            const material = new THREE.MeshPhongMaterial({
                color: CONFIG.LIGHT_COLOR,
                shininess: 80,
                specular: 0x333333,
                emissive: 0xff0044,
                emissiveIntensity: 0.1
            });
            
            const petal = new THREE.Mesh(geometry, material);
            petal.castShadow = true;
            petal.receiveShadow = true;
            
            return petal;
        }
        
        function createLeaf() {
            const shape = new THREE.Shape();
            shape.moveTo(0, 0);
            shape.quadraticCurveTo(0.3, 0.1, 0.4, 0.3);
            shape.quadraticCurveTo(0.3, 0.5, 0, 0.6);
            shape.quadraticCurveTo(-0.3, 0.5, -0.4, 0.3);
            shape.quadraticCurveTo(-0.3, 0.1, 0, 0);
            
            const extrudeSettings = {
                depth: 0.02,
                bevelEnabled: true,
                bevelSegments: 1,
                steps: 1,
                bevelSize: 0.01,
                bevelThickness: 0.01
            };
            
            const geometry = new THREE.ExtrudeGeometry(shape, extrudeSettings);
            const material = new THREE.MeshPhongMaterial({
                color: 0x32CD32,
                shininess: 30,
                side: THREE.DoubleSide
            });
            
            const leaf = new THREE.Mesh(geometry, material);
            leaf.castShadow = true;
            leaf.receiveShadow = true;
            
            return leaf;
        }
        
        // ÙˆØ¸Ø§Ø¦Ù Ø§Ù„ØªØ­ÙƒÙ… ÙÙŠ Ø§Ù„Ø²ÙˆÙ…
        function zoomIn() {
            if (controls) {
                camera.position.z *= 0.85;
                if (camera.position.z < controls.minDistance) {
                    camera.position.z = controls.minDistance;
                }
                controls.update();
            }
        }
        
        function zoomOut() {
            if (controls) {
                camera.position.z *= 1.15;
                if (camera.position.z > controls.maxDistance) {
                    camera.position.z = controls.maxDistance;
                }
                controls.update();
            }
        }
        
        function setZoomClose() {
            if (controls && camera) {
                camera.position.set(1, 1.2, CONFIG.ZOOM_CLOSE);
                camera.lookAt(0, 0, 0);
                controls.update();
            }
        }
        
        function setZoomDefault() {
            if (controls && camera) {
                camera.position.set(
                    CONFIG.CAMERA_POSITION.x,
                    CONFIG.CAMERA_POSITION.y,
                    CONFIG.ZOOM_DEFAULT
                );
                camera.lookAt(0, 0, 0);
                controls.update();
            }
        }
        
        function setZoomFar() {
            if (controls && camera) {
                camera.position.set(0.5, 2.5, CONFIG.ZOOM_FAR);
                camera.lookAt(0, 0, 0);
                controls.update();
            }
        }
        
        function toggleConfig() {
            document.getElementById('configPanel').classList.toggle('show');
        }
        
        function onWindowResize() {
            camera.aspect = window.innerWidth / window.innerHeight;
            camera.updateProjectionMatrix();
            renderer.setSize(window.innerWidth, window.innerHeight);
            
            // ØªØ¹Ø¯ÙŠÙ„ Ø­Ø¬Ù… Ø§Ù„Ø±Ø³Ø§Ù„Ø© Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ Ø­Ø¬Ù… Ø§Ù„Ø´Ø§Ø´Ø©
            adjustMessageSize();
        }
        
        function adjustMessageSize() {
            const message = document.getElementById('message');
            const screenHeight = window.innerHeight;
            const screenWidth = window.innerWidth;
            
            // ØªØ­Ø¯ÙŠØ¯ Ø§Ù„Ø­Ø¬Ù… Ø§Ù„Ù…Ù†Ø§Ø³Ø¨ Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ Ø§Ø±ØªÙØ§Ø¹ Ø§Ù„Ø´Ø§Ø´Ø©
            if (screenHeight < 600) {
                message.style.maxHeight = '40vh';
                message.style.bottom = '5px';
                message.style.padding = '8px 15px';
            } else if (screenHeight < 700) {
                message.style.maxHeight = '35vh';
                message.style.bottom = '8px';
                message.style.padding = '10px 18px';
            } else {
                message.style.maxHeight = '25vh';
                message.style.bottom = '10px';
                message.style.padding = '12px 20px';
            }
            
            // Ù„Ù„ØªÙˆØ¬ÙŠÙ‡ Ø§Ù„Ø£ÙÙ‚ÙŠ
            if (screenWidth > screenHeight) {
                message.style.maxWidth = '80%';
                message.style.maxHeight = '45vh';
            }
        }
        
        function animate() {
            requestAnimationFrame(animate);
            
            if (roseModel && isModelLoaded) {
                roseModel.rotation.y += CONFIG.ROTATION_SPEED;
            }
            
            controls.update();
            renderer.render(scene, camera);
        }
        
        // Ø¨Ø¯Ø¡ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚
        window.addEventListener('DOMContentLoaded', init);
        
        // Ø¥Ø®ÙØ§Ø¡ Ù„ÙˆØ­Ø© Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø¹Ù†Ø¯ Ø§Ù„Ù†Ù‚Ø± Ø®Ø§Ø±Ø¬Ù‡Ø§
        document.addEventListener('click', (event) => {
            const configPanel = document.getElementById('configPanel');
            const configBtn = document.querySelector('.config-btn');
            
            if (configPanel && configBtn) {
                if (!configPanel.contains(event.target) && !configBtn.contains(event.target)) {
                    configPanel.classList.remove('show');
                }
            }
        });
        
        // Ø§Ø®ØªØµØ§Ø±Ø§Øª Ù„ÙˆØ­Ø© Ø§Ù„Ù…ÙØ§ØªÙŠØ­
        document.addEventListener('keydown', (event) => {
            if (event.key === '+' || event.key === '=') {
                zoomIn();
                event.preventDefault();
            } else if (event.key === '-' || event.key === '_') {
                zoomOut();
                event.preventDefault();
            } else if (event.key === 'Escape') {
                const configPanel = document.getElementById('configPanel');
                if (configPanel) {
                    configPanel.classList.remove('show');
                }
            }
        });
        
        // Ù…Ù†Ø¹ Ø§Ù„ØªÙ…Ø±ÙŠØ± Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠ Ø¹Ù„Ù‰ Ø§Ù„Ù‡ÙˆØ§ØªÙ
        document.addEventListener('touchmove', (e) => {
            if (e.target.tagName === 'CANVAS') {
                e.preventDefault();
            }
        }, { passive: false });
    </script>
</body>
</html>