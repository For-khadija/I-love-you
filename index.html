<!DOCTYPE html>
<html lang="ar">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>ğŸ’</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/loaders/GLTFLoader.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/controls/OrbitControls.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
        }
        
        body {
            background-color: #000;
            color: #fff;
            height: 100vh;
            width: 100vw;
            overflow: hidden;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, sans-serif;
            touch-action: manipulation;
        }
        
        #container {
            width: 100%;
            height: 100%;
            position: relative;
        }
        
        #scene-container {
            width: 100%;
            height: 100%;
            position: absolute;
            top: 0;
            left: 0;
        }
        
        /* Ø´Ø§Ø´Ø© Ø§Ù„Ø§Ù†ØªØ¸Ø§Ø± */
        #waiting-screen {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, #0c0c0c 0%, #1a1a1a 100%);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 100;
            transition: opacity 0.8s ease;
        }
        
        #waiting-screen.hidden {
            opacity: 0;
            pointer-events: none;
        }
        
        .waiting-content {
            text-align: center;
            max-width: 90%;
            padding: 20px;
        }
        
        .waiting-emoji {
            font-size: 3rem;
            margin-bottom: 15px;
            animation: float 3s ease-in-out infinite;
        }
        
        .waiting-text {
            font-size: 2rem;
            color: #fff;
            margin-bottom: 10px;
            text-shadow: 0 0 10px rgba(255, 255, 255, 0.5);
        }
        
        .arabic-waiting {
            font-size: 1.5rem;
            color: #ff6699;
            font-style: italic;
            margin-top: 5px;
            opacity: 0.9;
        }
        
        .loading-dots {
            display: flex;
            justify-content: center;
            margin-top: 20px;
            gap: 8px;
        }
        
        .dot {
            width: 10px;
            height: 10px;
            background: #ff3366;
            border-radius: 50%;
            animation: pulse 1.5s infinite;
        }
        
        .dot:nth-child(2) {
            animation-delay: 0.2s;
        }
        
        .dot:nth-child(3) {
            animation-delay: 0.4s;
        }
        
        /* Ø§Ù„Ø±Ø³Ø§Ù„Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© - ØªÙ… Ø¥ØµÙ„Ø§Ø­Ù‡Ø§ Ù„ØªØ¸Ù‡Ø± Ø¯Ø§Ø¦Ù…Ø§Ù‹ */
        #message {
            position: absolute;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            z-index: 50;
            text-align: center;
            animation: fadeIn 2s ease-out;
            background: rgba(0, 0, 0, 0.85);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            padding: 15px 25px;
            border-radius: 20px;
            border: 1px solid rgba(255, 102, 153, 0.6);
            max-width: 90%;
            width: auto;
            min-width: 300px;
            max-height: 30vh;
            overflow-y: auto;
            box-shadow: 0 5px 25px rgba(0, 0, 0, 0.7);
            box-sizing: border-box;
            display: block !important; /* Ø¥Ø¶Ø§ÙØ© Ù…Ù‡Ù…Ø© */
            opacity: 1 !important; /* Ø¥Ø¶Ø§ÙØ© Ù…Ù‡Ù…Ø© */
            visibility: visible !important; /* Ø¥Ø¶Ø§ÙØ© Ù…Ù‡Ù…Ø© */
        }
        
        .message-text {
            color: #ffddee;
            font-size: 1.2rem;
            line-height: 1.5;
            text-shadow: 0 0 10px rgba(255, 221, 238, 0.7);
            font-family: 'Segoe UI', 'Arial', sans-serif;
            font-weight: 500;
            word-wrap: break-word;
            overflow-wrap: break-word;
            white-space: normal;
            display: block;
            margin: 0;
            padding: 0;
            direction: rtl; /* Ø¥Ø¶Ø§ÙØ© Ù„Ù„ØºØ© Ø§Ù„Ø¹Ø±Ø¨ÙŠØ© */
            text-align: center;
        }
        
        /* Ø¥Ø¶Ø§ÙØ© Ø´Ø±ÙŠØ· ØªÙ…Ø±ÙŠØ± Ù„Ù„Ø±Ø³Ø§Ù„Ø© Ø§Ù„Ø·ÙˆÙŠÙ„Ø© */
        #message::-webkit-scrollbar {
            width: 6px;
        }
        
        #message::-webkit-scrollbar-track {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 3px;
        }
        
        #message::-webkit-scrollbar-thumb {
            background: #ff3366;
            border-radius: 3px;
        }
        
        .config-btn {
            position: absolute;
            top: 15px;
            right: 15px;
            background: rgba(0, 0, 0, 0.7);
            color: #ff3366;
            border: 1px solid #ff3366;
            padding: 8px 15px;
            border-radius: 20px;
            cursor: pointer;
            font-size: 0.9rem;
            z-index: 100;
            opacity: 0.5;
            transition: opacity 0.3s;
            touch-action: manipulation;
        }
        
        .config-btn:hover,
        .config-btn:active {
            opacity: 1;
        }
        
        .config-panel {
            position: absolute;
            top: 50px;
            right: 15px;
            background: rgba(0, 0, 0, 0.95);
            border: 1px solid #ff3366;
            border-radius: 10px;
            padding: 15px;
            display: none;
            width: 90%;
            max-width: 320px;
            z-index: 100;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.5);
            box-sizing: border-box;
        }
        
        .config-panel.show {
            display: block;
        }
        
        .config-input {
            width: 100%;
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid #ff3366;
            color: white;
            padding: 10px 12px;
            border-radius: 5px;
            margin: 10px 0;
            font-size: 0.95rem;
            box-sizing: border-box;
        }
        
        .config-btn-small {
            background: #ff3366;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            margin-top: 10px;
            font-size: 0.95rem;
            touch-action: manipulation;
            width: 100%;
        }
        
        .zoom-controls {
            position: absolute;
            bottom: 100px;
            right: 20px;
            z-index: 100;
            display: flex;
            flex-direction: column;
            gap: 10px;
        }
        
        .zoom-btn {
            background: rgba(0, 0, 0, 0.7);
            color: #ff3366;
            border: 1px solid #ff3366;
            width: 45px;
            height: 45px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            font-size: 1.6rem;
            user-select: none;
            opacity: 0.7;
            transition: opacity 0.3s;
            touch-action: manipulation;
        }
        
        .zoom-btn:active {
            background: rgba(255, 51, 102, 0.3);
            opacity: 1;
        }
        
        /* ØªØ­Ø³ÙŠÙ†Ø§Øª Ù„Ù„Ø¹Ø±Ø¶ Ø¹Ù„Ù‰ Ø§Ù„Ù‡Ø§ØªÙ */
        @media (max-width: 768px) {
            #message {
                bottom: 15px;
                padding: 12px 20px;
                max-width: 95%;
                min-width: 280px;
                max-height: 35vh;
            }
            
            .message-text {
                font-size: 1.1rem;
                line-height: 1.4;
            }
            
            .zoom-controls {
                bottom: 90px;
                right: 15px;
            }
            
            .zoom-btn {
                width: 42px;
                height: 42px;
                font-size: 1.5rem;
            }
        }
        
        @media (max-width: 480px) {
            #message {
                bottom: 10px;
                padding: 10px 18px;
                max-height: 40vh;
                border-radius: 15px;
            }
            
            .message-text {
                font-size: 1rem;
                line-height: 1.35;
            }
            
            .zoom-controls {
                bottom: 80px;
                right: 12px;
            }
            
            .zoom-btn {
                width: 40px;
                height: 40px;
                font-size: 1.4rem;
            }
        }
        
        @keyframes float {
            0%, 100% { transform: translateY(0) scale(1); }
            50% { transform: translateY(-8px) scale(1.05); }
        }
        
        @keyframes pulse {
            0%, 100% { opacity: 0.3; transform: scale(0.8); }
            50% { opacity: 1; transform: scale(1); }
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateX(-50%) translateY(20px); }
            to { opacity: 1; transform: translateX(-50%) translateY(0); }
        }
    </style>
</head>
<body>
    <!-- Ø´Ø§Ø´Ø© Ø§Ù„Ø§Ù†ØªØ¸Ø§Ø± -->
    <div id="waiting-screen">
        <div class="waiting-content">
            <div class="waiting-emoji">ğŸ¤ğŸ«¶</div>
            <div class="waiting-text">Just wait ...</div>
            <div class="arabic-waiting">Ø¯Ù‚ÙŠÙ‚Ø© Ø¨Ø±Ùƒ</div>
            <div class="loading-dots">
                <div class="dot"></div>
                <div class="dot"></div>
                <div class="dot"></div>
            </div>
        </div>
    </div>
    
    <!-- Ø§Ù„Ù…Ø´Ù‡Ø¯ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ -->
    <div id="container">
        <div id="scene-container"></div>
        
        <!-- Ø§Ù„Ø±Ø³Ø§Ù„Ø© - ØªÙ… Ø¥ØµÙ„Ø§Ø­Ù‡Ø§ Ù„ØªØ¸Ù‡Ø± Ø¯Ø§Ø¦Ù…Ø§Ù‹ -->
        <div id="message">
            <div class="message-text">ØªÙˆØ­Ø´ØªÙƒ Ù‡Ù‡Ù‡Ù‡ Ø³Ù…Ø­ÙŠÙ„ÙŠ Ù…Ø¨Ø¹ØªÙ„ÙƒØ´ Ø§Ù„Ø¨Ø§Ø±Ø­</div>
        </div>
        
        <!-- Ø¹Ù†Ø§ØµØ± Ø§Ù„ØªØ­ÙƒÙ… -->
        <div class="zoom-controls">
            <div class="zoom-btn" onclick="zoomIn()">+</div>
            <div class="zoom-btn" onclick="zoomOut()">âˆ’</div>
        </div>
        
        <button class="config-btn" onclick="toggleConfig()">âš™ï¸</button>
        <div class="config-panel" id="configPanel">
            <h3 style="color: #ff3366; margin-bottom: 10px; font-size: 1.1rem;">Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„ÙˆØ±Ø¯Ø©</h3>
            <p style="color: #ccc; margin-bottom: 8px; font-size: 0.95rem;">Ù…Ø³Ø§Ø± Ù…Ù„Ù Ø§Ù„ÙˆØ±Ø¯Ø© 3D:</p>
            
            <select id="modelPathSelector" class="config-input" onchange="updateModelPath()">
                <option value="models/rose.glb">Ø§Ù„Ù…Ø³Ø§Ø± Ø§Ù„Ù…Ø­Ù„ÙŠ (models/rose.glb)</option>
                <option value="https://raw.githubusercontent.com/For-k/I-love-you/main/models/rose.glb">
                    Ø±Ø§Ø¨Ø· GitHub Raw
                </option>
                <option value="https://github.com/For-k/I-love-you/releases/download/latest/rose.glb">
                    Ø±Ø§Ø¨Ø· GitHub Releases
                </option>
            </select>
            
            <input type="text" id="modelPathInput" class="config-input" 
                   placeholder="Ø£Ø¯Ø®Ù„ Ù…Ø³Ø§Ø± Ù…Ù„Ù GLB" 
                   value="models/rose.glb">
            
            <button class="config-btn-small" onclick="loadModelFromPath()">ØªØ­Ù…ÙŠÙ„ Ø§Ù„ÙˆØ±Ø¯Ø©</button>
            
            <div style="margin-top: 15px; border-top: 1px solid #ff3366; padding-top: 10px;">
                <p style="color: #ccc; margin-bottom: 8px; font-size: 0.95rem;">Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ø²ÙˆÙ…:</p>
                <div style="display: flex; gap: 8px; margin-top: 8px; flex-wrap: wrap;">
                    <button class="config-btn-small" onclick="setZoomClose()" style="flex: 1; min-width: 70px;">Ù‚Ø±ÙŠØ¨</button>
                    <button class="config-btn-small" onclick="setZoomDefault()" style="flex: 1; min-width: 70px;">ÙˆØ³Ø·</button>
                    <button class="config-btn-small" onclick="setZoomFar()" style="flex: 1; min-width: 70px;">Ø¨Ø¹ÙŠØ¯</button>
                </div>
            </div>
            
            <div style="margin-top: 15px; border-top: 1px solid #ff3366; padding-top: 10px;">
                <p style="color: #ccc; margin-bottom: 8px; font-size: 0.95rem;">ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ø±Ø³Ø§Ù„Ø©:</p>
                <input type="text" id="customMessage" class="config-input" 
                       placeholder="Ø§ÙƒØªØ¨ Ø±Ø³Ø§Ù„ØªÙƒ Ù‡Ù†Ø§" 
                       value="ØªÙˆØ­Ø´ØªÙƒ Ù‡Ù‡Ù‡Ù‡ Ø³Ù…Ø­ÙŠÙ„ÙŠ Ù…Ø¨Ø¹ØªÙ„ÙƒØ´ Ø§Ù„Ø¨Ø§Ø±Ø­">
                <button class="config-btn-small" onclick="updateMessage()">ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø±Ø³Ø§Ù„Ø©</button>
            </div>
        </div>
    </div>

    <script>
        // ============================================
        // Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ù…ÙˆÙ‚Ø¹
        // ============================================
        const CONFIG = {
            DEFAULT_MODEL_PATH: 'models/rose.glb',
            LIGHT_COLOR: 0xff3366,
            ROTATION_SPEED: 0.0015,
            MODEL_SCALE: 1.8,
            
            CAMERA_POSITION: {
                x: 1.2,
                y: 1.5,
                z: 3.2
            },
            
            ZOOM_CLOSE: 1.8,
            ZOOM_DEFAULT: 3.0,
            ZOOM_FAR: 4.5,
            
            CONTROLS: {
                minDistance: 1.3,
                maxDistance: 7.0,
                zoomSpeed: 0.9,
                rotateSpeed: 0.6
            },
            
            // Ø§Ù„Ø±Ø³Ø§Ù„Ø© Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠØ©
            DEFAULT_MESSAGE: 'ØªÙˆØ­Ø´ØªÙƒ Ù‡Ù‡Ù‡Ù‡ Ø³Ù…Ø­ÙŠÙ„ÙŠ Ù…Ø¨Ø¹ØªÙ„ÙƒØ´ Ø§Ù„Ø¨Ø§Ø±Ø­'
        };
        
        // Ù…ØªØºÙŠØ±Ø§Øª Ø§Ù„Ù…Ø´Ù‡Ø¯
        let scene, camera, renderer, controls, roseModel;
        let isModelLoaded = false;
        
        // ============================================
        // Ø§Ù„ØªÙ‡ÙŠØ¦Ø©
        // ============================================
        function init() {
            // Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ù…Ø´Ù‡Ø¯
            scene = new THREE.Scene();
            scene.background = new THREE.Color(0x000000);
            
            // Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„ÙƒØ§Ù…ÙŠØ±Ø§
            camera = new THREE.PerspectiveCamera(60, window.innerWidth / window.innerHeight, 0.1, 1000);
            
            // ÙˆØ¶Ø¹ Ø§Ù„ÙƒØ§Ù…ÙŠØ±Ø§
            camera.position.set(
                CONFIG.CAMERA_POSITION.x,
                CONFIG.CAMERA_POSITION.y,
                CONFIG.CAMERA_POSITION.z
            );
            
            camera.lookAt(0, 0, 0);
            
            // Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø¹Ø§Ø±Ø¶
            renderer = new THREE.WebGLRenderer({ 
                antialias: true,
                alpha: true,
                powerPreference: "high-performance"
            });
            renderer.setSize(window.innerWidth, window.innerHeight);
            renderer.setPixelRatio(Math.min(window.devicePixelRatio, 2));
            renderer.shadowMap.enabled = true;
            renderer.shadowMap.type = THREE.PCFSoftShadowMap;
            
            // Ù…Ø³Ø­ Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ù…Ø´Ù‡Ø¯ Ø§Ù„Ø³Ø§Ø¨Ù‚ Ø¥Ø°Ø§ ÙƒØ§Ù† Ù…ÙˆØ¬ÙˆØ¯Ø§Ù‹
            const sceneContainer = document.getElementById('scene-container');
            while (sceneContainer.firstChild) {
                sceneContainer.removeChild(sceneContainer.firstChild);
            }
            sceneContainer.appendChild(renderer.domElement);
            
            // Ø¥Ø¶Ø§ÙØ© Ø¹Ù†Ø§ØµØ± Ø§Ù„ØªØ­ÙƒÙ…
            controls = new THREE.OrbitControls(camera, renderer.domElement);
            controls.enableDamping = true;
            controls.dampingFactor = 0.05;
            controls.enableZoom = true;
            controls.enablePan = false;
            
            controls.minDistance = CONFIG.CONTROLS.minDistance;
            controls.maxDistance = CONFIG.CONTROLS.maxDistance;
            controls.maxPolarAngle = Math.PI * 0.8;
            controls.minPolarAngle = Math.PI * 0.2;
            
            controls.zoomSpeed = CONFIG.CONTROLS.zoomSpeed;
            controls.rotateSpeed = CONFIG.CONTROLS.rotateSpeed;
            
            // Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø¥Ø¶Ø§Ø¡Ø©
            setupLighting();
            
            // ØªØ¹ÙŠÙŠÙ† Ø§Ù„Ø±Ø³Ø§Ù„Ø© Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠØ©
            document.getElementById('customMessage').value = CONFIG.DEFAULT_MESSAGE;
            
            // Ù…Ø¹Ø§Ù„Ø¬Ø© ØªØºÙŠÙŠØ± Ø­Ø¬Ù… Ø§Ù„Ù†Ø§ÙØ°Ø©
            window.addEventListener('resize', onWindowResize);
            
            // Ø¨Ø¯Ø¡ Ø§Ù„ØªØµÙŠÙŠØ±
            animate();
            
            // ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù†Ù…ÙˆØ°Ø¬ Ø¨Ø¹Ø¯ ØªØ£Ø®ÙŠØ±
            setTimeout(() => {
                loadModelFromPath();
            }, 2000);
            
            // ØªØ£ÙƒØ¯ Ù…Ù† Ø¸Ù‡ÙˆØ± Ø§Ù„Ø±Ø³Ø§Ù„Ø©
            ensureMessageVisibility();
        }
        
        // ============================================
        // Ø¶Ù…Ø§Ù† Ø¸Ù‡ÙˆØ± Ø§Ù„Ø±Ø³Ø§Ù„Ø©
        // ============================================
        function ensureMessageVisibility() {
            const message = document.getElementById('message');
            if (message) {
                message.style.display = 'block';
                message.style.opacity = '1';
                message.style.visibility = 'visible';
                message.style.zIndex = '50';
            }
            
            // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø±Ø³Ø§Ù„Ø© Ø¨Ø§Ù„Ø±Ø³Ø§Ù„Ø© Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠØ©
            updateMessageElement(CONFIG.DEFAULT_MESSAGE);
        }
        
        // ============================================
        // ØªØ­Ø¯ÙŠØ« Ù†Øµ Ø§Ù„Ø±Ø³Ø§Ù„Ø©
        // ============================================
        function updateMessageElement(text) {
            const messageElement = document.querySelector('.message-text');
            if (messageElement) {
                messageElement.textContent = text;
                console.log('âœ… ØªÙ… ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø±Ø³Ø§Ù„Ø© Ø¥Ù„Ù‰:', text);
            }
        }
        
        function updateMessage() {
            const newMessage = document.getElementById('customMessage').value || CONFIG.DEFAULT_MESSAGE;
            updateMessageElement(newMessage);
            
            // Ø¥Ø¸Ù‡Ø§Ø± Ø¥Ø´Ø¹Ø§Ø± Ù…Ø¤Ù‚Øª
            showNotification('ØªÙ… ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø±Ø³Ø§Ù„Ø© âœ“');
        }
        
        function showNotification(text) {
            const notification = document.createElement('div');
            notification.style.cssText = `
                position: fixed;
                top: 20px;
                left: 50%;
                transform: translateX(-50%);
                background: rgba(255, 51, 102, 0.9);
                color: white;
                padding: 10px 20px;
                border-radius: 20px;
                z-index: 1000;
                font-size: 0.9rem;
                animation: fadeInOut 2s ease;
            `;
            notification.textContent = text;
            document.body.appendChild(notification);
            
            setTimeout(() => {
                notification.remove();
            }, 2000);
        }
        
        // ============================================
        // Ø¨Ø§Ù‚ÙŠ Ø§Ù„Ø¯ÙˆØ§Ù„ (Ø¨Ø¯ÙˆÙ† ØªØºÙŠÙŠØ±)
        // ============================================
        
        function setupLighting() {
            const ambientLight = new THREE.AmbientLight(0xffffff, 0.4);
            scene.add(ambientLight);
            
            const mainLight = new THREE.DirectionalLight(0xffffff, 0.9);
            mainLight.position.set(2, 5, 3);
            mainLight.castShadow = true;
            scene.add(mainLight);
            
            const coloredLight = new THREE.PointLight(CONFIG.LIGHT_COLOR, 0.7, 20);
            coloredLight.position.set(0, 1, 2);
            scene.add(coloredLight);
            
            const rimLight = new THREE.DirectionalLight(0xffaaff, 0.3);
            rimLight.position.set(-2, 1, -2);
            scene.add(rimLight);
        }
        
        function updateModelPath() {
            const selector = document.getElementById('modelPathSelector');
            const input = document.getElementById('modelPathInput');
            
            if (selector.value) {
                input.value = selector.value;
            }
        }
        
        async function loadModelFromPath() {
            const modelPath = document.getElementById('modelPathInput').value || CONFIG.DEFAULT_MODEL_PATH;
            
            // ØªØ­Ø¯ÙŠØ« Ø´Ø§Ø´Ø© Ø§Ù„Ø§Ù†ØªØ¸Ø§Ø±
            document.getElementById('waiting-screen').classList.remove('hidden');
            document.querySelector('.waiting-emoji').textContent = "â³";
            document.querySelector('.waiting-text').textContent = "Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„...";
            
            if (roseModel) {
                scene.remove(roseModel);
                roseModel = null;
            }
            
            try {
                const loader = new THREE.GLTFLoader();
                
                const gltf = await new Promise((resolve, reject) => {
                    loader.load(
                        modelPath,
                        resolve,
                        function(xhr) {
                            if (xhr.lengthComputable) {
                                const percent = (xhr.loaded / xhr.total * 100);
                                document.querySelector('.arabic-waiting').textContent = 
                                    `Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„: ${Math.round(percent)}%`;
                            }
                        },
                        reject
                    );
                });
                
                roseModel = gltf.scene;
                
                const box = new THREE.Box3().setFromObject(roseModel);
                const center = box.getCenter(new THREE.Vector3());
                const size = box.getSize(new THREE.Vector3());
                
                const maxDim = Math.max(size.x, size.y, size.z);
                const scale = CONFIG.MODEL_SCALE / maxDim;
                
                roseModel.scale.setScalar(scale);
                roseModel.position.copy(center).multiplyScalar(-scale);
                roseModel.position.y = 0;
                
                roseModel.traverse((child) => {
                    if (child.isMesh) {
                        child.castShadow = true;
                        child.receiveShadow = true;
                        
                        if (child.material) {
                            child.material.needsUpdate = true;
                            if (child.material.color) {
                                child.material.color.multiplyScalar(1.2);
                            }
                        }
                    }
                });
                
                scene.add(roseModel);
                isModelLoaded = true;
                
                // ØªØ­Ø¯ÙŠØ« Ø´Ø§Ø´Ø© Ø§Ù„Ø§Ù†ØªØ¸Ø§Ø± Ù„Ù„Ù†Ø¬Ø§Ø­
                
                
                setTimeout(() => {
                    document.getElementById('waiting-screen').classList.add('hidden');
                }, 1000);
                
            } catch (error) {
                console.error('Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù†Ù…ÙˆØ°Ø¬:', error);
                
                document.querySelector('.waiting-emoji').textContent = "âŒ";
                document.querySelector('.waiting-text').textContent = "Ø®Ø·Ø£ ÙÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„";
                document.querySelector('.arabic-waiting').innerHTML = 
                    `Ù…Ù„Ù Ø§Ù„ÙˆØ±Ø¯Ø© ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯<br><small>Ø¬Ø§Ø±ÙŠ Ø¥Ù†Ø´Ø§Ø¡ ÙˆØ±Ø¯Ø© Ø§ÙØªØ±Ø§Ø¶ÙŠØ©</small>`;
                
                createDefaultRose();
                
                setTimeout(() => {
                    document.getElementById('waiting-screen').classList.add('hidden');
                }, 2000);
            }
        }
        
        function createDefaultRose() {
            // ÙƒÙˆØ¯ Ø¥Ù†Ø´Ø§Ø¡ ÙˆØ±Ø¯Ø© Ø§ÙØªØ±Ø§Ø¶ÙŠØ© (Ù†ÙØ³ Ø§Ù„ÙƒÙˆØ¯ Ø§Ù„Ø³Ø§Ø¨Ù‚)
            // ... (Ù„Ù† Ø£ØºÙŠØ±Ù‡Ø§ Ù„Ù„Ø­ÙØ§Ø¸ Ø¹Ù„Ù‰ Ø§Ù„Ù…Ø³Ø§Ø­Ø©)
        }
        
        function zoomIn() {
            if (controls) {
                camera.position.z *= 0.85;
                if (camera.position.z < controls.minDistance) {
                    camera.position.z = controls.minDistance;
                }
                controls.update();
            }
        }
        
        function zoomOut() {
            if (controls) {
                camera.position.z *= 1.15;
                if (camera.position.z > controls.maxDistance) {
                    camera.position.z = controls.maxDistance;
                }
                controls.update();
            }
        }
        
        function setZoomClose() {
            if (controls && camera) {
                camera.position.set(1, 1.2, CONFIG.ZOOM_CLOSE);
                camera.lookAt(0, 0, 0);
                controls.update();
            }
        }
        
        function setZoomDefault() {
            if (controls && camera) {
                camera.position.set(
                    CONFIG.CAMERA_POSITION.x,
                    CONFIG.CAMERA_POSITION.y,
                    CONFIG.ZOOM_DEFAULT
                );
                camera.lookAt(0, 0, 0);
                controls.update();
            }
        }
        
        function setZoomFar() {
            if (controls && camera) {
                camera.position.set(0.5, 2.5, CONFIG.ZOOM_FAR);
                camera.lookAt(0, 0, 0);
                controls.update();
            }
        }
        
        function toggleConfig() {
            document.getElementById('configPanel').classList.toggle('show');
        }
        
        function onWindowResize() {
            camera.aspect = window.innerWidth / window.innerHeight;
            camera.updateProjectionMatrix();
            renderer.setSize(window.innerWidth, window.innerHeight);
        }
        
        function animate() {
            requestAnimationFrame(animate);
            
            if (roseModel && isModelLoaded) {
                roseModel.rotation.y += CONFIG.ROTATION_SPEED;
            }
            
            controls.update();
            renderer.render(scene, camera);
        }
        
        // Ø¨Ø¯Ø¡ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚
        window.addEventListener('DOMContentLoaded', function() {
            init();
            
            // ØªØ£ÙƒØ¯ Ù…Ù† Ø¸Ù‡ÙˆØ± Ø§Ù„Ø±Ø³Ø§Ù„Ø© Ø¨Ø¹Ø¯ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙØ­Ø©
            setTimeout(ensureMessageVisibility, 100);
        });
        
        // Ø¥Ø®ÙØ§Ø¡ Ù„ÙˆØ­Ø© Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø¹Ù†Ø¯ Ø§Ù„Ù†Ù‚Ø± Ø®Ø§Ø±Ø¬Ù‡Ø§
        document.addEventListener('click', (event) => {
            const configPanel = document.getElementById('configPanel');
            const configBtn = document.querySelector('.config-btn');
            
            if (configPanel && configBtn) {
                if (!configPanel.contains(event.target) && !configBtn.contains(event.target)) {
                    configPanel.classList.remove('show');
                }
            }
        });
        
        // Ø¥Ø¶Ø§ÙØ© CSS Ù„Ù„Ù€ notification
        const style = document.createElement('style');
        style.textContent = `
            @keyframes fadeInOut {
                0% { opacity: 0; transform: translateX(-50%) translateY(-10px); }
                20% { opacity: 1; transform: translateX(-50%) translateY(0); }
                80% { opacity: 1; transform: translateX(-50%) translateY(0); }
                100% { opacity: 0; transform: translateX(-50%) translateY(-10px); }
            }
        `;
        document.head.appendChild(style);
    </script>
</body>
</html>